<div class="container-fluid">
  <div class="d-flex">
    <div>
      <img
        src="{{ movieDetail.posterUrl }}"
        height="500"
        width="500"
        class="img-fluid"
        style="object-fit: contain"
        alt="not found"
        (error)="
          movieDetail.posterUrl =
            'http://localhost:4200/assets/not_found_movie.svg'
        "
      />
    </div>
    <div class="mx-4 flex-grow-1">
      <h4>{{ movieDetail.title }} ({{ movieDetail.releaseDateStr }})</h4>

      <div class="d-flex align-items-center">
        <div class="d-block">
          <ngb-rating
            [(rate)]="movieDetail.rating"
            [starTemplate]="starTemplate"
            [readonly]="true"
            [max]="10"
          />
        </div>
        <span class="ms-2">({{ movieDetail.ratingCount }})</span>
      </div>

      <span class="fw-normal d-block mt-3"
        >Genres :
        <div
          class="bg-info d-inline ms-2 py-2 px-4 rounded-pill text-white"
          *ngFor="let genre of movieDetail.genreList"
        >
          {{ genre }}
        </div>
      </span>

      <div class="mt-3" *ngIf="movieDetail.duration != null">
        {{ getHourlyTime(movieDetail.duration) }}
      </div>

      <div class="mt-3">
        {{ movieDetail.overview }}
      </div>

      <div class="mt-3">Revenue: ${{ movieDetail.revenue }}</div>

      <div class="mt-3">Budget: ${{ movieDetail.budget }}</div>
      <!-- <span>{{movieDetail.genres}}</span> -->

      <ng-template #starTemplate let-fill="fill">
        <i class="bi-star-fill">
          @if (fill > 0) {
          <i class="bi-star-fill filled" [style.width.%]="fill"></i>
          }
        </i>
      </ng-template>

      <form>
        <h6 class="mt-2">Submit Your Review Here</h6>
        <div style="width: 100px">
          <ngb-rating
            [(rate)]="reviewRating"
            [starTemplate]="starTemplate"
            [readonly]="false"
            [max]="10"
          />
        </div>

        <div class="form-floating">
          <textarea
            class="center flex roboto-thin form-control"
            [(ngModel)]="reviewDesc"
            name="description"
            type="text"
            placeholder="Describe Your Experience"
          ></textarea>
          <label for="">Describe Your Experience</label>
        </div>

        <button class="float-end btn btn-warning mt-2" (click)="submitReview()">
          Submit Review
        </button>
      </form>
    </div>
  </div>

  <div class="row">
    <div *ngFor="let rating of reviewsList" class="col-md-6 mt-3">
      <app-review-card
        [userName]="getFullName(rating.user)"
        [desc]="rating.description"
        [rating]="rating.rating"
      ></app-review-card>
    </div>

    <div class="d-flex justify-content-center">
      <app-pagination-button
        [currentPage]="currentPageNumber"
        [itemsPerPage]="reviewPageSize"
        [totalItems]="totalItems"
        (pageChanged)="onPageChange($event)"
      ></app-pagination-button>
    </div>
  </div>
</div>
